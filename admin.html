<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin panel for managing chiropractors and blog posts.">
    <title>Admin Panel - Just Chiropractor</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <h2>üè• Just Chiropractor</h2>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="directory.html">Directory</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="admin.html" class="active">Admin</a></li>
            </ul>
        </div>
    </nav>

    <!-- Admin Header -->
    <div class="admin-header">
        <div class="container">
            <h1>Admin Panel</h1>
            <p>Manage chiropractors and blog posts</p>
        </div>
    </div>

    <!-- Admin Content -->
    <section class="admin-content">
        <div class="container">
            <!-- Tab Navigation -->
            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('chiropractors')">Chiropractors</button>
                <button class="tab-btn" onclick="switchTab('blog')">Blog Posts</button>
            </div>

            <!-- Chiropractors Tab -->
            <div id="chiropractors-tab" class="tab-content active">
                <div class="admin-section">
                    <div class="section-header">
                        <h2>Manage Chiropractors</h2>
                        <button onclick="showAddChiropractorForm()" class="btn btn-primary">Add New Chiropractor</button>
                    </div>

                    <!-- Add/Edit Form -->
                    <div id="chiro-form-container" class="form-container" style="display: none;">
                        <div class="form-card">
                            <h3 id="chiro-form-title">Add New Chiropractor</h3>
                            <form id="chiropractorForm" onsubmit="saveChiropractor(event)">
                                <input type="hidden" id="chiro-id">
                                
                                <div class="form-group">
                                    <label for="chiro-name">Name *</label>
                                    <input type="text" id="chiro-name" required placeholder="Dr. John Smith">
                                </div>

                                <div class="form-group">
                                    <label for="chiro-state">State *</label>
                                    <select id="chiro-state" required>
                                        <option value="">Select State</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="chiro-address">Address *</label>
                                    <input type="text" id="chiro-address" required placeholder="123 Main Street, City, State ZIP">
                                </div>

                                <div class="form-group">
                                    <label for="chiro-phone">Phone *</label>
                                    <input type="tel" id="chiro-phone" required placeholder="(555) 123-4567">
                                </div>

                                <div class="form-group">
                                    <label for="chiro-email">Email *</label>
                                    <input type="email" id="chiro-email" required placeholder="doctor@example.com">
                                </div>

                                <div class="form-group">
                                    <label for="chiro-website">Website</label>
                                    <input type="url" id="chiro-website" placeholder="https://www.example.com">
                                </div>

                                <div class="form-group">
                                    <label for="chiro-specialty">Specialty</label>
                                    <input type="text" id="chiro-specialty" placeholder="Sports Injury & Rehabilitation">
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">Save</button>
                                    <button type="button" onclick="cancelChiroForm()" class="btn btn-secondary">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Chiropractors List -->
                    <div id="chiro-list" class="data-list">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <!-- Blog Tab -->
            <div id="blog-tab" class="tab-content">
                <div class="admin-section">
                    <div class="section-header">
                        <h2>Manage Blog Posts</h2>
                        <button onclick="showAddBlogForm()" class="btn btn-primary">Add New Post</button>
                    </div>

                    <!-- Add/Edit Form -->
                    <div id="blog-form-container" class="form-container" style="display: none;">
                        <div class="form-card">
                            <h3 id="blog-form-title">Add New Blog Post</h3>
                            <form id="blogForm" onsubmit="saveBlogPost(event)">
                                <input type="hidden" id="blog-id">
                                
                                <div class="form-group">
                                    <label for="blog-title">Title *</label>
                                    <input type="text" id="blog-title" required placeholder="Enter blog post title">
                                </div>

                                <div class="form-group">
                                    <label for="blog-author">Author *</label>
                                    <input type="text" id="blog-author" required placeholder="Dr. John Smith">
                                </div>

                                <div class="form-group">
                                    <label for="blog-tags">Tags (comma-separated)</label>
                                    <input type="text" id="blog-tags" placeholder="Health, Wellness, Tips">
                                </div>

                                <div class="form-group">
                                    <label for="blog-featured-image">Featured Image URL</label>
                                    <input type="url" id="blog-featured-image" placeholder="https://example.com/image.jpg">
                                    <small style="color: var(--text-light); display: block; margin-top: 0.5rem;">Optional: Enter the URL of an image to display with your blog post</small>
                                </div>

                                <div class="form-group">
                                    <label for="blog-content">Content *</label>
                                    <textarea id="blog-content" required rows="10" placeholder="Write your blog post content here..."></textarea>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" class="btn btn-primary">Save</button>
                                    <button type="button" onclick="cancelBlogForm()" class="btn btn-secondary">Cancel</button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Blog Posts List -->
                    <div id="blog-list" class="data-list">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Just Chiropractor</h3>
                    <p>Your trusted source for finding chiropractors across the USA</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="directory.html">Directory</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="admin.html">Admin</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="sitemap.xml">Sitemap</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Just Chiropractor. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            populateStateSelector('chiro-state');
            loadChiropractorsList();
            loadBlogPostsList();
        });

        // Tab Management
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(`${tab}-tab`).classList.add('active');
        }

        // Chiropractor Management
        function showAddChiropractorForm() {
            document.getElementById('chiro-form-title').textContent = 'Add New Chiropractor';
            document.getElementById('chiropractorForm').reset();
            document.getElementById('chiro-id').value = '';
            document.getElementById('chiro-form-container').style.display = 'block';
            document.getElementById('chiro-form-container').scrollIntoView({ behavior: 'smooth' });
        }

        function editChiropractor(id) {
            const chiropractors = getChiropractors();
            const chiro = chiropractors.find(c => c.id === id);
            
            if (!chiro) return;

            document.getElementById('chiro-form-title').textContent = 'Edit Chiropractor';
            document.getElementById('chiro-id').value = chiro.id;
            document.getElementById('chiro-name').value = chiro.name;
            document.getElementById('chiro-state').value = chiro.state;
            document.getElementById('chiro-address').value = chiro.address;
            document.getElementById('chiro-phone').value = chiro.phone;
            document.getElementById('chiro-email').value = chiro.email;
            document.getElementById('chiro-website').value = chiro.website || '';
            document.getElementById('chiro-specialty').value = chiro.specialty || '';
            
            document.getElementById('chiro-form-container').style.display = 'block';
            document.getElementById('chiro-form-container').scrollIntoView({ behavior: 'smooth' });
        }

        function saveChiropractor(event) {
            event.preventDefault();
            
            const id = document.getElementById('chiro-id').value;
            const chiropractor = {
                name: document.getElementById('chiro-name').value,
                state: document.getElementById('chiro-state').value,
                address: document.getElementById('chiro-address').value,
                phone: document.getElementById('chiro-phone').value,
                email: document.getElementById('chiro-email').value,
                website: document.getElementById('chiro-website').value,
                specialty: document.getElementById('chiro-specialty').value
            };

            if (id) {
                updateChiropractor(id, chiropractor);
                alert('Chiropractor updated successfully!');
            } else {
                addChiropractor(chiropractor);
                alert('Chiropractor added successfully!');
            }

            cancelChiroForm();
            loadChiropractorsList();
        }

        function deleteChiropractorConfirm(id) {
            if (confirm('Are you sure you want to delete this chiropractor?')) {
                deleteChiropractor(id);
                loadChiropractorsList();
                alert('Chiropractor deleted successfully!');
            }
        }

        function cancelChiroForm() {
            document.getElementById('chiropractorForm').reset();
            document.getElementById('chiro-form-container').style.display = 'none';
        }

        function loadChiropractorsList() {
            const chiropractors = getChiropractors();
            const container = document.getElementById('chiro-list');

            if (chiropractors.length === 0) {
                container.innerHTML = '<p class="no-data">No chiropractors found. Add your first one above!</p>';
                return;
            }

            container.innerHTML = chiropractors.map(chiro => `
                <div class="data-item">
                    <div class="data-item-header">
                        <h3>${chiro.name}</h3>
                        <span class="state-badge">${chiro.state}</span>
                    </div>
                    <div class="data-item-body">
                        <p><strong>Specialty:</strong> ${chiro.specialty || 'General Chiropractic'}</p>
                        <p><strong>Address:</strong> ${chiro.address}</p>
                        <p><strong>Phone:</strong> ${chiro.phone}</p>
                        <p><strong>Email:</strong> ${chiro.email}</p>
                    </div>
                    <div class="data-item-actions">
                        <button onclick="editChiropractor('${chiro.id}')" class="btn btn-secondary btn-sm">Edit</button>
                        <button onclick="deleteChiropractorConfirm('${chiro.id}')" class="btn btn-danger btn-sm">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        // Blog Post Management
        function showAddBlogForm() {
            document.getElementById('blog-form-title').textContent = 'Add New Blog Post';
            document.getElementById('blogForm').reset();
            document.getElementById('blog-id').value = '';
            document.getElementById('blog-form-container').style.display = 'block';
            document.getElementById('blog-form-container').scrollIntoView({ behavior: 'smooth' });
        }

        function editBlogPost(id) {
            const posts = getBlogPosts();
            const post = posts.find(p => p.id === id);
            
            if (!post) return;

            document.getElementById('blog-form-title').textContent = 'Edit Blog Post';
            document.getElementById('blog-id').value = post.id;
            document.getElementById('blog-title').value = post.title;
            document.getElementById('blog-author').value = post.author;
            document.getElementById('blog-tags').value = post.tags ? post.tags.join(', ') : '';
            document.getElementById('blog-featured-image').value = post.featuredImage || '';
            document.getElementById('blog-content').value = post.content;
            
            document.getElementById('blog-form-container').style.display = 'block';
            document.getElementById('blog-form-container').scrollIntoView({ behavior: 'smooth' });
        }

        function saveBlogPost(event) {
            event.preventDefault();
            
            const id = document.getElementById('blog-id').value;
            const tagsInput = document.getElementById('blog-tags').value;
            const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
            const featuredImage = document.getElementById('blog-featured-image').value;

            const post = {
                title: document.getElementById('blog-title').value,
                author: document.getElementById('blog-author').value,
                content: document.getElementById('blog-content').value,
                tags: tags,
                featuredImage: featuredImage || ''
            };

            if (id) {
                updateBlogPost(id, post);
                alert('Blog post updated successfully!');
            } else {
                addBlogPost(post);
                alert('Blog post added successfully!');
            }

            cancelBlogForm();
            loadBlogPostsList();
        }

        function deleteBlogPostConfirm(id) {
            if (confirm('Are you sure you want to delete this blog post?')) {
                deleteBlogPost(id);
                loadBlogPostsList();
                alert('Blog post deleted successfully!');
            }
        }

        function cancelBlogForm() {
            document.getElementById('blogForm').reset();
            document.getElementById('blog-form-container').style.display = 'none';
        }

        function loadBlogPostsList() {
            const posts = getBlogPosts();
            const container = document.getElementById('blog-list');

            if (posts.length === 0) {
                container.innerHTML = '<p class="no-data">No blog posts found. Add your first one above!</p>';
                return;
            }

            container.innerHTML = posts.map(post => `
                <div class="data-item">
                    <div class="data-item-header">
                        <h3>${post.title}</h3>
                    </div>
                    <div class="data-item-body">
                        <p><strong>Author:</strong> ${post.author}</p>
                        <p><strong>Date:</strong> ${formatDate(post.date)}</p>
                        ${post.tags && post.tags.length > 0 ? `
                            <p><strong>Tags:</strong> ${post.tags.join(', ')}</p>
                        ` : ''}
                        <p class="excerpt">${post.content.substring(0, 200)}...</p>
                    </div>
                    <div class="data-item-actions">
                        <button onclick="editBlogPost('${post.id}')" class="btn btn-secondary btn-sm">Edit</button>
                        <button onclick="deleteBlogPostConfirm('${post.id}')" class="btn btn-danger btn-sm">Delete</button>
                    </div>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
